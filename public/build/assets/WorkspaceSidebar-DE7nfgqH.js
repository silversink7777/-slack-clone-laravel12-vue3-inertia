import{e as u,o as d,a,d as p,q as y,A as C,u as s,Q as v,b as I,f as m,t as h,G as _,z as w}from"./app-CkYNA2PG.js";function j(g,n){return d(),u("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"})])}const M={class:"w-20 bg-slack-purple-darker dark:bg-gray-900 text-white p-2"},U={key:0,class:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center min-w-[20px]"},A={key:0,class:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center min-w-[20px]"},D={__name:"WorkspaceSidebar",setup(g){const n=p(0);let i=null;const l=async()=>{try{const e=await w.get("/my-invitations");e.data&&Array.isArray(e.data)&&(n.value=e.data.length)}catch(e){console.error("Failed to fetch invitation count:",e),n.value=0}},x=()=>{i&&clearInterval(i),i=setInterval(l,3e4)},b=()=>{v.visit("/invitations")},o=p(0);let t=null;const c=async()=>{try{const e=await w.get("/api/direct-messages/unread-count");e.data&&typeof e.data.count=="number"&&(o.value=e.data.count)}catch(e){console.error("Failed to fetch DM unread count:",e),o.value=0}},k=()=>{t&&clearInterval(t),t=setInterval(c,3e4)},f=()=>{o.value=0,t&&(clearInterval(t),t=null),setTimeout(()=>{c()},1e3)};return y(()=>{l(),x(),window.addEventListener("invitation-count-updated",l),window.addEventListener("dm-unread-count-updated",f),c(),k()}),C(()=>{i&&clearInterval(i),window.removeEventListener("invitation-count-updated",l),window.removeEventListener("dm-unread-count-updated",f),t&&clearInterval(t)}),(e,r)=>(d(),u("div",M,[a("button",{onClick:r[0]||(r[0]=()=>s(v).visit("/")),class:"rounded-lg bg-white text-purple-900 w-12 h-12 flex items-center justify-center text-2xl font-bold mb-4 hover:bg-gray-100 transition-colors cursor-pointer",title:"トップ画面に戻る"}," T "),a("button",{onClick:b,class:"relative w-12 h-12 rounded-lg hover:bg-purple-700 flex items-center justify-center mb-2 transition-colors",title:"招待通知"},[I(s(j),{class:"h-6 w-6"}),n.value>0?(d(),u("div",U,h(n.value>99?"99+":n.value),1)):m("",!0)]),a("button",{onClick:r[1]||(r[1]=()=>{s(t)&&(e.clearInterval(s(t)),_(t)?t.value=null:t=null),s(v).visit("/direct-messages")}),class:"relative w-12 h-12 rounded-lg hover:bg-purple-700 flex items-center justify-center mb-2 transition-colors",title:"ダイレクトメッセージ"},[r[2]||(r[2]=a("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})],-1)),o.value>0?(d(),u("div",A,h(o.value>99?"99+":o.value),1)):m("",!0)])]))}};export{D as _};
