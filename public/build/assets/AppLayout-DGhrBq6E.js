import{e as o,o as l,a as e,B as U,d as f,q as T,A as F,b as r,t as y,u as m,f as k,Q as H,k as S,v as L,z as C,C as O,g as A,F as I,h as P,p as Q,r as D}from"./app-By_hQbVH.js";import{r as B,b as R,_ as q,a as G}from"./ChannelListSidebar-Cq7gRj-H.js";function J(n,d){return l(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 12a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0Zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 1 0-2.636 6.364M16.5 12V8.25"})])}function W(n,d){return l(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m4.5 12.75 6 6 9-13.5"})])}function X(n,d){return l(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function Y(n,d){return l(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.182 15.182a4.5 4.5 0 0 1-6.364 0M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0ZM9.75 9.75c0 .414-.168.75-.375.75S9 10.164 9 9.75 9.168 9 9.375 9s.375.336.375.75Zm-.375 0h.008v.015h-.008V9.75Zm5.625 0c0 .414-.168.75-.375.75s-.375-.336-.375-.75.168-.75.375-.75.375.336.375.75Zm-.375 0h.008v.015h-.008V9.75Z"})])}function ee(n,d){return l(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})])}function te(n,d){return l(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 18.75a6 6 0 0 0 6-6v-1.5m-6 7.5a6 6 0 0 1-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 0 1-3-3V4.5a3 3 0 1 1 6 0v8.25a3 3 0 0 1-3 3Z"})])}function se(n,d){return l(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5"})])}function ne(n,d){return l(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"})])}function ae(n,d){return l(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})])}function oe(n,d){return l(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})])}function le(n,d){return l(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m15.75 10.5 4.72-4.72a.75.75 0 0 1 1.28.53v11.38a.75.75 0 0 1-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25h-9A2.25 2.25 0 0 0 2.25 7.5v9a2.25 2.25 0 0 0 2.25 2.25Z"})])}function Z(n,d){return l(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"})])}const re={class:"h-16 border-b border-gray-200 bg-white flex items-center justify-between px-6"},ie={class:"flex items-center font-bold"},de={class:"flex items-center space-x-4"},ce={class:"relative"},ue={class:"text-sm font-medium"},he={key:0,class:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50 border border-gray-200"},ge={__name:"MainHeader",props:{activeChannel:Object},setup(n){var g;const i=(g=U().props.auth)==null?void 0:g.user,h=f(!1),t=f(null),s=()=>{H.post(route("logout"))},c=()=>{h.value=!h.value},p=()=>{h.value=!1},u=a=>{t.value&&!t.value.contains(a.target)&&p()};return T(()=>{document.addEventListener("click",u)}),F(()=>{document.removeEventListener("click",u)}),(a,x)=>{var w,$;return l(),o("div",re,[e("div",null,[e("button",ie,[e("span",null,y((w=n.activeChannel)==null?void 0:w.name),1),r(m(B),{class:"h-5 w-5 ml-1"})])]),e("div",de,[r(m(X),{class:"h-6 w-6 text-gray-500"}),e("div",ce,[r(m(ee),{class:"h-5 w-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),x[0]||(x[0]=e("input",{type:"text",placeholder:"test 内を検索する",class:"bg-gray-100 rounded-md w-80 pl-10 pr-4 py-1.5 focus:ring-blue-500 focus:border-blue-500 border-transparent"},null,-1))]),e("div",{ref_key:"userMenuRef",ref:t,class:"relative"},[e("button",{onClick:c,class:"flex items-center space-x-2 text-gray-700 hover:text-gray-900 focus:outline-none"},[r(m(R),{class:"h-8 w-8"}),e("span",ue,y(($=m(i))==null?void 0:$.name),1),r(m(B),{class:"h-4 w-4"})]),h.value?(l(),o("div",he,[e("button",{onClick:s,class:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"}," ログアウト ")])):k("",!0)],512)])])}}},ve={class:"p-4 bg-white border-t border-gray-200"},me={class:"border rounded-lg p-2 flex flex-col"},fe=["disabled"],pe={class:"flex items-center justify-between mt-2"},xe={class:"flex items-center space-x-2"},we={class:"text-gray-500 hover:text-gray-800"},be={class:"text-gray-500 hover:text-gray-800"},_e={class:"text-gray-500 hover:text-gray-800"},ye={class:"flex items-center space-x-2"},ke={class:"text-gray-500 hover:text-gray-800"},$e={class:"text-gray-500 hover:text-gray-800"},Ce=["disabled"],Me={__name:"MessageInput",props:{activeChannel:Object},emits:["messageSent"],setup(n,{emit:d}){const i=n,h=d,t=f(""),s=f(!1),c=async()=>{if(!(!t.value.trim()||!i.activeChannel)){s.value=!0;try{const u=await C.post("/messages",{content:t.value.trim(),channel_id:i.activeChannel.id});h("messageSent",u.data),t.value=""}catch(u){console.error("Message sending failed:",u)}finally{s.value=!1}}},p=u=>{u.key==="Enter"&&!u.shiftKey&&(u.preventDefault(),c())};return(u,g)=>(l(),o("div",ve,[e("div",me,[S(e("textarea",{"onUpdate:modelValue":g[0]||(g[0]=a=>t.value=a),onKeypress:p,class:"w-full border-none focus:ring-0 resize-none",placeholder:"メモを書く",rows:"1",disabled:s.value},null,40,fe),[[L,t.value]]),e("div",pe,[e("div",xe,[e("button",we,[r(m(ae),{class:"h-6 w-6"})]),e("button",be,[r(m(le),{class:"h-6 w-6"})]),e("button",_e,[r(m(te),{class:"h-6 w-6"})])]),e("div",ye,[e("button",ke,[r(m(Y),{class:"h-6 w-6"})]),e("button",$e,[r(m(J),{class:"h-6 w-6"})]),e("button",{onClick:c,disabled:!t.value.trim()||s.value,class:"bg-gray-800 text-white rounded p-1 hover:bg-gray-700 disabled:bg-gray-400 disabled:cursor-not-allowed"},[r(m(se),{class:"h-5 w-5"})],8,Ce)])])])]))}},je={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},De={class:"bg-white rounded-lg p-6 w-full max-w-md mx-4"},Be={class:"flex items-center justify-between mb-4"},Ue={class:"mb-4"},Se=["disabled"],Le={key:0,class:"mt-2 text-red-600 text-sm"},Oe={class:"flex justify-end space-x-3"},Ae=["disabled"],Ze=["disabled"],Ve={__name:"MessageEditModal",props:{show:Boolean,message:Object},emits:["close","messageUpdated"],setup(n,{emit:d}){const i=n,h=d,t=f(""),s=f(!1),c=f("");O(()=>i.message,a=>{a&&(t.value=a.content,c.value="")},{immediate:!0});const p=async()=>{var a,x;if(!(!t.value.trim()||!i.message)){s.value=!0,c.value="";try{const w=await C.put(`/messages/${i.message.id}`,{content:t.value.trim()});h("messageUpdated",w.data),h("close")}catch(w){console.error("Message update failed:",w),(x=(a=w.response)==null?void 0:a.data)!=null&&x.message?c.value=w.response.data.message:c.value="メッセージの更新に失敗しました"}finally{s.value=!1}}},u=()=>{var a;t.value=((a=i.message)==null?void 0:a.content)||"",c.value="",h("close")},g=a=>{a.key==="Enter"&&!a.shiftKey&&(a.preventDefault(),p())};return(a,x)=>n.show?(l(),o("div",je,[e("div",De,[e("div",Be,[x[1]||(x[1]=e("h3",{class:"text-lg font-semibold"},"メッセージを編集",-1)),e("button",{onClick:u,class:"text-gray-500 hover:text-gray-700"},[r(m(Z),{class:"h-6 w-6"})])]),e("div",Ue,[S(e("textarea",{"onUpdate:modelValue":x[0]||(x[0]=w=>t.value=w),onKeypress:g,class:"w-full border border-gray-300 rounded-lg p-3 focus:ring-blue-500 focus:border-blue-500 resize-none",placeholder:"メッセージを入力してください",rows:"4",disabled:s.value},null,40,Se),[[L,t.value]]),c.value?(l(),o("div",Le,y(c.value),1)):k("",!0)]),e("div",Oe,[e("button",{onClick:u,class:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:s.value}," キャンセル ",8,Ae),e("button",{onClick:p,disabled:!t.value.trim()||s.value,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center space-x-2"},[r(m(W),{class:"h-4 w-4"}),e("span",null,y(s.value?"更新中...":"更新"),1)],8,Ze)])])])):k("",!0)}},Ee={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ze={class:"bg-white rounded-lg p-6 w-full max-w-md mx-4"},Ke={class:"flex items-center justify-between mb-4"},Ne={class:"mb-4 text-gray-700"},Te={class:"mt-2 p-2 bg-gray-100 rounded text-gray-800"},Fe={key:0,class:"mt-2 text-red-600 text-sm"},He={class:"flex justify-end space-x-3"},Ie=["disabled"],Pe=["disabled"],Qe={__name:"MessageDeleteModal",props:{show:Boolean,message:Object},emits:["close","messageDeleted"],setup(n,{emit:d}){const i=n,h=d,t=f(!1),s=f(""),c=async()=>{var u,g;if(i.message){t.value=!0,s.value="";try{await C.delete(`/messages/${i.message.id}`),h("messageDeleted",i.message.id),h("close")}catch(a){s.value=((g=(u=a.response)==null?void 0:u.data)==null?void 0:g.message)||"削除に失敗しました"}finally{t.value=!1}}},p=()=>{s.value="",h("close")};return(u,g)=>{var a;return n.show?(l(),o("div",Ee,[e("div",ze,[e("div",Ke,[g[0]||(g[0]=e("h3",{class:"text-lg font-semibold"},"メッセージを削除",-1)),e("button",{onClick:p,class:"text-gray-500 hover:text-gray-700"},[r(m(Z),{class:"h-6 w-6"})])]),e("div",Ne,[g[1]||(g[1]=A(" 本当にこのメッセージを削除しますか？ ")),e("div",Te,y((a=n.message)==null?void 0:a.content),1),s.value?(l(),o("div",Fe,y(s.value),1)):k("",!0)]),e("div",He,[e("button",{onClick:p,class:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:t.value}," キャンセル ",8,Ie),e("button",{onClick:c,disabled:t.value,class:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center space-x-2"},[r(m(oe),{class:"h-4 w-4"}),e("span",null,y(t.value?"削除中...":"削除"),1)],8,Pe)])])])):k("",!0)}}},Re={class:"flex-1 flex flex-col bg-white"},qe={class:"flex-1 p-6 overflow-y-auto"},Ge={class:"flex-1"},Je={class:"flex items-center justify-between"},We={class:"font-bold"},Xe={class:"text-xs text-gray-500 font-normal ml-2"},Ye={class:"flex items-center space-x-2 opacity-0 group-hover:opacity-100 transition-opacity"},et=["onClick"],tt=["onClick"],st={class:"text-gray-800"},nt={__name:"MainContent",props:{messages:{type:Array,default:()=>[]},activeChannel:Object},emits:["messageSent","messageUpdated","messageDeleted"],setup(n,{emit:d}){var j;const h=(j=U().props.auth)==null?void 0:j.user,t=n,s=d,c=f([...t.messages||[]]),p=f(!1),u=f(null),g=f(!1),a=f(null);O(()=>t.messages,v=>{c.value=[...v||[]]},{deep:!0});const x=v=>{c.value.unshift(v),s("messageSent",v)},w=v=>{const _=c.value.findIndex(b=>b.id===v.id);_!==-1&&(c.value[_]=v),s("messageUpdated",v)},$=v=>{const _=c.value.findIndex(b=>b.id===v);_!==-1&&c.value.splice(_,1),s("messageDeleted",v)},V=v=>{u.value=v,p.value=!0},E=()=>{p.value=!1,u.value=null},z=v=>{a.value=v,g.value=!0},K=()=>{g.value=!1,a.value=null},M=v=>h&&v.user.id===h.id;return(v,_)=>(l(),o("div",Re,[r(ge,{"active-channel":n.activeChannel},null,8,["active-channel"]),e("div",qe,[(l(!0),o(I,null,P(c.value,b=>(l(),o("div",{key:b.id,class:"flex items-start mb-4 group hover:bg-gray-50 rounded-lg p-2 -m-2"},[_[1]||(_[1]=e("div",{class:"w-10 h-10 rounded bg-purple-400 mr-4 shrink-0"},null,-1)),e("div",Ge,[e("div",Je,[e("p",We,[A(y(b.user.name)+" ",1),e("span",Xe,y(b.time),1)]),e("div",Ye,[M(b)?(l(),o("button",{key:0,onClick:N=>V(b),class:"text-gray-500 hover:text-gray-700 p-1 rounded",title:"メッセージを編集"},[r(m(ne),{class:"h-4 w-4"})],8,et)):k("",!0),M(b)?(l(),o("button",{key:1,onClick:N=>z(b),class:"text-red-500 hover:text-red-700 p-1 rounded",title:"メッセージを削除"},_[0]||(_[0]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-4 w-4"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,tt)):k("",!0)])]),e("p",st,y(b.content),1)])]))),128))]),r(Me,{"active-channel":n.activeChannel,onMessageSent:x},null,8,["active-channel"]),r(Ve,{show:p.value,message:u.value,onClose:E,onMessageUpdated:w},null,8,["show","message"]),r(Qe,{show:g.value,message:a.value,onClose:K,onMessageDeleted:$},null,8,["show","message"])]))}},at={class:"flex h-screen bg-gray-100 text-gray-800"},ot={class:"flex-1 flex flex-col"},it={__name:"AppLayout",props:{title:String,channels:Array,"direct-messages":Array,messages:Array,activeChannel:Object,manualOffline:Boolean},emits:["selectChannel","newChannelAdded","messageSent","messageUpdated","messageDeleted","toggleManualOffline","channelDeleted","channelLeft"],setup(n,{emit:d}){const i=d;return(h,t)=>(l(),o("div",null,[r(m(Q),{title:n.title},null,8,["title"]),e("div",at,[r(q),r(G,{channels:n.channels,"direct-messages":h.direct-n.messages,"manual-offline":n.manualOffline,onToggleManualOffline:t[0]||(t[0]=s=>i("toggleManualOffline",s)),onSelectChannel:t[1]||(t[1]=s=>i("selectChannel",s)),onNewChannelAdded:t[2]||(t[2]=s=>i("newChannelAdded",s)),onChannelDeleted:t[3]||(t[3]=s=>i("channelDeleted",s)),onChannelLeft:t[4]||(t[4]=s=>i("channelLeft",s))},null,8,["channels","direct-messages","manual-offline"]),e("div",ot,[D(h.$slots,"notifications"),D(h.$slots,"default"),r(nt,{messages:n.messages,"active-channel":n.activeChannel,onMessageSent:t[5]||(t[5]=s=>i("messageSent",s)),onMessageUpdated:t[6]||(t[6]=s=>i("messageUpdated",s)),onMessageDeleted:t[7]||(t[7]=s=>i("messageDeleted",s))},null,8,["messages","active-channel"])])])]))}};export{it as _};
