import{B as N,d as y,q as M,A as j,e as f,o as u,b as p,a as e,u as _,p as R,r as A,t as c,f as k,Q as $,s as C,F as B,h as T,g as S,i as U,c as L,w as E}from"./app-PgSOKnUn.js";import{_ as V,a as D,r as I,b as F}from"./ChannelListSidebar-BPdy8Zmu.js";import"./Modal-BHW6xvs7.js";import"./PrimaryButton-BNhFOszE.js";import"./SecondaryButton-CtUa-bff.js";const P={class:"flex h-screen bg-gray-100 text-gray-800"},q={class:"flex-1 flex flex-col"},z={class:"h-16 border-b border-gray-200 bg-white flex items-center justify-between px-6"},J={class:"flex items-center font-bold"},Q={class:"flex items-center space-x-4"},H={class:"text-sm font-medium"},K={key:0,class:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50 border border-gray-200"},X={__name:"InvitationLayout",props:{title:String,channels:Array,"direct-messages":Array,manualOffline:Boolean},emits:["toggleManualOffline","selectChannel","newChannelAdded"],setup(a,{emit:i}){var x;const l=i,h=(x=N().props.auth)==null?void 0:x.user,m=y(!1),o=y(null),r=()=>{$.post(route("logout"))},b=()=>{m.value=!m.value},w=()=>{m.value=!1},v=s=>{o.value&&!o.value.contains(s.target)&&w()};return M(()=>{document.addEventListener("click",v)}),j(()=>{document.removeEventListener("click",v)}),(s,t)=>{var n;return u(),f("div",null,[p(_(R),{title:a.title},null,8,["title"]),e("div",P,[p(V),p(D,{channels:a.channels,"direct-messages":s.direct-s.messages,"manual-offline":a.manualOffline,onToggleManualOffline:t[0]||(t[0]=d=>l("toggleManualOffline",d)),onSelectChannel:t[1]||(t[1]=d=>l("selectChannel",d)),onNewChannelAdded:t[2]||(t[2]=d=>l("newChannelAdded",d))},null,8,["channels","direct-messages","manual-offline"]),e("div",q,[e("div",z,[e("div",null,[e("button",J,[e("span",null,c(a.title),1),p(_(I),{class:"h-5 w-5 ml-1"})])]),e("div",Q,[e("div",{ref_key:"userMenuRef",ref:o,class:"relative"},[e("button",{onClick:b,class:"flex items-center space-x-2 text-gray-700 hover:text-gray-900 focus:outline-none"},[p(_(F),{class:"h-8 w-8"}),e("span",H,c((n=_(h))==null?void 0:n.name),1),p(_(I),{class:"h-4 w-4"})]),m.value?(u(),f("div",K,[e("button",{onClick:r,class:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"}," ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ ")])):k("",!0)],512)])]),A(s.$slots,"notifications"),A(s.$slots,"default")])])])}}},G={key:0,class:"space-y-6 max-w-md mx-auto"},W=["data-invitation-id"],Y={class:"flex items-center gap-4 flex-1 min-w-0"},Z={class:"h-12 w-12 rounded-full bg-indigo-100 flex items-center justify-center text-xl font-bold text-indigo-600"},ee={class:"min-w-0"},te={class:"font-semibold text-lg text-gray-900 truncate"},se={class:"text-sm text-gray-500 truncate"},ne={class:"font-medium text-indigo-700"},oe={key:0,class:"text-sm text-gray-500 truncate"},ae={class:"font-medium text-indigo-700"},ie={class:"flex flex-col gap-0.5 mt-1"},le={class:"text-xs text-gray-400"},re={class:"text-xs text-orange-600"},de={class:"flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-2 min-w-fit"},ce=["onClick","disabled"],ue=["onClick","disabled"],me={key:1,class:"bg-white shadow rounded-lg max-w-lg mx-auto mt-8"},fe={__name:"InvitationNotification",props:{invitations:{type:Array,default:()=>[]}},emits:["invitation-responded"],setup(a,{emit:i}){const l=a,g=i,h=y([]),m=y(!1),o=y(""),r=y(null),b=C(()=>l.invitations.length>0?l.invitations:h.value),w=async()=>{if(!(l.invitations.length>0)){m.value=!0,o.value="";try{const s=await fetch("/my-invitations"),t=await s.json();s.ok?h.value=t:o.value=t.message||"æ‹›å¾…ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ"}catch{o.value="æ‹›å¾…ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ"}finally{m.value=!1}}},v=async(s,t)=>{if(r.value!==s){r.value=s;try{const n=await fetch(`/invitations/${s}/respond`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({action:t})}),d=await n.json();n.ok?(l.invitations.length>0?g("invitation-responded",{invitationId:s,action:t,data:d}):h.value=h.value.filter(O=>O.id!==s),g("invitation-responded",{invitationId:s,action:t,data:d}),window.dispatchEvent(new CustomEvent("invitation-count-updated"))):o.value=d.message||"æ‹›å¾…ã®å¿œç­”ã«å¤±æ•—ã—ã¾ã—ãŸ"}catch{o.value="æ‹›å¾…ã®å¿œç­”ã«å¤±æ•—ã—ã¾ã—ãŸ"}finally{r.value=null}}},x=s=>new Date(s).toLocaleString("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});return M(()=>{w()}),(s,t)=>b.value.length>0?(u(),f("div",G,[(u(!0),f(B,null,T(b.value,n=>(u(),f("div",{key:n.id,"data-invitation-id":n.id,class:"bg-white shadow rounded-xl p-5 flex flex-row items-center justify-between gap-4 border border-gray-100 transition-all duration-300"},[e("div",Y,[e("div",Z,c(n.inviter.name.charAt(0).toUpperCase()),1),e("div",ee,[e("div",te,c(n.channel.name),1),e("div",se,[t[0]||(t[0]=S("æ‹›å¾…è€…: ")),e("span",ne,c(n.inviter.name),1)]),n.invitee?(u(),f("div",oe,[t[1]||(t[1]=S(" æ‹›å¾…å…ˆ: ")),e("span",ae,c(n.invitee.name||n.invitee.email),1)])):k("",!0),e("div",ie,[e("span",le,"æ‹›å¾…æ—¥æ™‚: "+c(x(n.created_at)),1),e("span",re,"æœ‰åŠ¹æœŸé™: "+c(x(n.expires_at)),1)])])]),e("div",de,[e("button",{onClick:d=>v(n.id,"accept"),class:"px-4 py-2 rounded font-semibold text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:ring-offset-2 transition disabled:opacity-60",disabled:r.value===n.id},c(r.value===n.id?"å‡¦ç†ä¸­...":"æ‰¿èª"),9,ce),e("button",{onClick:d=>v(n.id,"decline"),class:"px-4 py-2 rounded font-semibold text-gray-700 bg-gray-100 hover:bg-gray-200 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 transition disabled:opacity-60",disabled:r.value===n.id},c(r.value===n.id?"å‡¦ç†ä¸­...":"æ‹’å¦"),9,ue)])],8,W))),128))])):(u(),f("div",me,t[2]||(t[2]=[U('<div class="px-4 py-5 sm:p-6 text-center"><div class="text-gray-400 mb-4"><svg class="mx-auto h-12 w-12" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5v-5z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 002 2z"></path></svg></div><h3 class="text-lg font-medium text-gray-900 mb-2">æ‹›å¾…é€šçŸ¥ã¯ã‚ã‚Šã¾ã›ã‚“</h3><p class="text-gray-500">ç¾åœ¨ã€ã‚ãªãŸã¸ã®æ‹›å¾…é€šçŸ¥ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p></div>',1)])))}},ge={class:"w-full max-w-lg mx-auto pt-8"},he={key:0,class:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg"},ve={key:1,class:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg"},xe={class:"flex items-center"},pe={class:"ml-3"},ye={class:"mt-3"},be=["href"],we=["href"],_e={class:"mt-4"},Se={__name:"Invitations",props:{channels:{type:Array,default:()=>[]},"direct-messages":{type:Array,default:()=>[]},invitations:{type:Array,default:()=>[]},messages:{type:Array,default:()=>[]},manualOffline:{type:Boolean,default:!1},isAuthenticated:{type:Boolean,default:!1}},setup(a){const i=a,l=new URLSearchParams(window.location.search),g=l.get("invitation"),h=l.get("registered"),m=C(()=>!i["direct-messages"]||!Array.isArray(i["direct-messages"])?[]:i["direct-messages"]),o=C(()=>i.invitations.filter(s=>!s.invitee_id)),r=y(h==="true"),b=s=>{s.action==="accept"?(alert("ãƒãƒ£ãƒ³ãƒãƒ«ã«å‚åŠ ã—ã¾ã—ãŸï¼"),window.location.reload()):s.action==="decline"&&(alert("æ‹›å¾…ã‚’æ‹’å¦ã—ã¾ã—ãŸã€‚"),window.location.reload())},w=s=>{$.visit(`/dashboard?channel=${s}`)},v=s=>{$.put("/api/user/online-status",{manual_offline:s})},x=s=>{console.log("New channel added:",s)};return M(()=>{if(console.log("Invitations page props:",i),console.log("Invitations count:",i.invitations.length),console.log("Invitations data:",i.invitations),console.log("Invitation ID from URL:",g),g){const s=i.invitations.find(t=>t.id==g);s&&(console.log("Found target invitation:",s),setTimeout(()=>{const t=document.querySelector(`[data-invitation-id="${g}"]`);t&&(t.scrollIntoView({behavior:"smooth",block:"center"}),t.classList.add("ring-2","ring-indigo-500","ring-opacity-50"))},500))}}),(s,t)=>(u(),L(X,{title:"æ‹›å¾…é€šçŸ¥",channels:a.channels,"direct-messages":m.value,messages:a.messages,"manual-offline":a.manualOffline,onSelectChannel:w,onToggleManualOffline:v,onNewChannelAdded:x},{default:E(()=>[e("div",ge,[t[4]||(t[4]=e("h1",{class:"text-2xl font-bold text-gray-900 text-center"},"æ‹›å¾…é€šçŸ¥",-1)),t[5]||(t[5]=e("p",{class:"text-gray-600 mt-2 text-center"},"ã‚ãªãŸãŒæ‹›å¾…ã•ã‚ŒãŸãƒãƒ£ãƒ³ãƒãƒ«ã®é€šçŸ¥ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚",-1)),r.value?(u(),f("div",he,t[0]||(t[0]=[e("div",{class:"flex items-center"},[e("div",{class:"flex-shrink-0"},[e("div",{class:"h-8 w-8 rounded-full bg-green-100 flex items-center justify-center"},[e("span",{class:"text-green-600 text-sm font-medium"},"âœ…")])]),e("div",{class:"ml-3"},[e("h3",{class:"text-sm font-medium text-green-800"}," ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆå®Œäº†ï¼ "),e("p",{class:"text-sm text-green-600 mt-1"}," ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒæ­£å¸¸ã«ä½œæˆã•ã‚Œã€ãƒãƒ£ãƒ³ãƒãƒ«ã«è‡ªå‹•å‚åŠ ã—ã¾ã—ãŸã€‚ ")])],-1)]))):k("",!0),!a.isAuthenticated&&o.value.length>0?(u(),f("div",ve,[e("div",xe,[t[3]||(t[3]=e("div",{class:"flex-shrink-0"},[e("div",{class:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center"},[e("span",{class:"text-blue-600 text-sm font-medium"},"ğŸ“")])],-1)),e("div",pe,[t[1]||(t[1]=e("h3",{class:"text-sm font-medium text-blue-800"}," ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã—ã¦ãƒãƒ£ãƒ³ãƒãƒ«ã«å‚åŠ  ",-1)),t[2]||(t[2]=e("p",{class:"text-sm text-blue-600 mt-1"}," æ‹›å¾…ã‚’å—ã‘ã‚‹ã«ã¯ã€ã¾ãšSlack Cloneã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ ",-1)),e("div",ye,[e("a",{href:`/register?invitation=${o.value[0].id}&email=${encodeURIComponent(o.value[0].invitee_email)}`,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ ",8,be),e("a",{href:`/login?email=${encodeURIComponent(o.value[0].invitee_email)}`,class:"ml-3 inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"}," æ—¢å­˜ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ ",8,we)])])])])):k("",!0),e("div",_e,[p(fe,{invitations:a.invitations,onInvitationResponded:b},null,8,["invitations"])])])]),_:1},8,["channels","direct-messages","messages","manual-offline"]))}};export{Se as default};
