import{e as a,o as s,a as e,d as x,B as X,q as W,z as P,A as ne,f as w,c as z,b,u as g,t as y,n as K,C as le,k as G,v as J,g as I,F as R,h as H,Q as ee,j as te,w as q,y as de,p as ue,r as se}from"./app-B-MHB3Dy.js";import{_ as he}from"./WorkspaceSidebar-DSsTK3oG.js";import{r as Q,a as ve,_ as ge}from"./ChannelListSidebar-Ds5gHz1m.js";import{_ as me}from"./DialogModal-DVr4rY9c.js";function fe(r,v){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 12a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0Zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 1 0-2.636 6.364M16.5 12V8.25"})])}function N(r,v){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m4.5 12.75 6 6 9-13.5"})])}function pe(r,v){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function ye(r,v){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 17.25v1.007a3 3 0 0 1-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0 1 15 18.257V17.25m6-12V15a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 15V5.25m18 0A2.25 2.25 0 0 0 18.75 3H5.25A2.25 2.25 0 0 0 3 5.25m18 0V12a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 12V5.25"})])}function xe(r,v){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.182 15.182a4.5 4.5 0 0 1-6.364 0M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0ZM9.75 9.75c0 .414-.168.75-.375.75S9 10.164 9 9.75 9.168 9 9.375 9s.375.336.375.75Zm-.375 0h.008v.015h-.008V9.75Zm5.625 0c0 .414-.168.75-.375.75s-.375-.336-.375-.75.168-.75.375-.75.375.336.375.75Zm-.375 0h.008v.015h-.008V9.75Z"})])}function ke(r,v){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})])}function _e(r,v){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 18.75a6 6 0 0 0 6-6v-1.5m-6 7.5a6 6 0 0 1-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 0 1-3-3V4.5a3 3 0 1 1 6 0v8.25a3 3 0 0 1-3 3Z"})])}function ae(r,v){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z"})])}function we(r,v){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5"})])}function re(r,v){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"})])}function be(r,v){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})])}function oe(r,v){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"})])}function $e(r,v){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})])}function Ce(r,v){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m15.75 10.5 4.72-4.72a.75.75 0 0 1 1.28.53v11.38a.75.75 0 0 1-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25h-9A2.25 2.25 0 0 0 2.25 7.5v9a2.25 2.25 0 0 0 2.25 2.25Z"})])}function ie(r,v){return s(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"})])}function Me(){const r=x("system"),v=x(!1),u=x(!1),m=()=>window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",d=n=>{(n==="system"?m():n)==="dark"?(document.documentElement.classList.add("dark"),v.value=!0):(document.documentElement.classList.remove("dark"),v.value=!1)},c=async()=>{try{const n=await P.get("/api/auth/check");return console.log("Auth status:",n.data),n.data.authenticated}catch(n){return console.error("Failed to check auth status:",n),!1}},o=async()=>{var n,i;try{u.value=!0,console.log("Loading theme...");const h=await c();console.log("Is authenticated:",h);const f=await P.get("/theme");console.log("Theme loaded successfully:",f.data),r.value=f.data.theme,d(r.value)}catch(h){console.error("Failed to load theme:",h),console.error("Error response:",(n=h.response)==null?void 0:n.data),console.error("Error status:",(i=h.response)==null?void 0:i.status),r.value="system",d("system")}finally{u.value=!1}},l=async n=>{var i,h;try{u.value=!0,console.log("Updating theme to:",n);const f=await c();console.log("Is authenticated:",f),await P.post("/theme",{theme:n}),console.log("Theme updated successfully"),r.value=n,d(n)}catch(f){throw console.error("Failed to update theme:",f),console.error("Error response:",(i=f.response)==null?void 0:i.data),console.error("Error status:",(h=f.response)==null?void 0:h.status),f}finally{u.value=!1}},p=()=>{window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{r.value==="system"&&d("system")})};return X(r,n=>{d(n)}),W(()=>{o(),p()}),{theme:r,isDark:v,isLoading:u,updateTheme:l,loadTheme:o}}const je={class:"relative"},De=["disabled"],Le={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},Se={key:0,class:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 z-50"},Be={class:"py-1"},Ae={__name:"ThemeToggle",setup(r){const{theme:v,isDark:u,isLoading:m,updateTheme:d}=Me(),c=x(!1),o=n=>{switch(n){case"light":return"ライト";case"dark":return"ダーク";case"system":return"システム";default:return"システム"}},l=async n=>{try{await d(n),c.value=!1}catch(i){console.error("Failed to update theme:",i),alert("テーマの更新に失敗しました")}},p=n=>{n.target.closest(".relative")||(c.value=!1)};return W(()=>{document.addEventListener("click",p)}),ne(()=>{document.removeEventListener("click",p)}),(n,i)=>(s(),a("div",je,[e("button",{onClick:i[0]||(i[0]=h=>c.value=!c.value),class:"flex items-center space-x-2 px-3 py-2 rounded-lg bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",disabled:g(m)},[g(u)?(s(),z(g(oe),{key:0,class:"h-5 w-5 text-yellow-500"})):(s(),z(g(ae),{key:1,class:"h-5 w-5 text-gray-600 dark:text-gray-400"})),e("span",Le,y(o(g(v))),1),b(g(Q),{class:"h-4 w-4 text-gray-500 dark:text-gray-400"})],8,De),c.value?(s(),a("div",Se,[e("div",Be,[e("button",{onClick:i[1]||(i[1]=h=>l("light")),class:K(["w-full flex items-center space-x-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",{"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400":g(v)==="light"}])},[b(g(oe),{class:"h-4 w-4"}),i[4]||(i[4]=e("span",null,"ライト",-1)),g(v)==="light"?(s(),z(g(N),{key:0,class:"h-4 w-4 ml-auto"})):w("",!0)],2),e("button",{onClick:i[2]||(i[2]=h=>l("dark")),class:K(["w-full flex items-center space-x-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",{"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400":g(v)==="dark"}])},[b(g(ae),{class:"h-4 w-4"}),i[5]||(i[5]=e("span",null,"ダーク",-1)),g(v)==="dark"?(s(),z(g(N),{key:0,class:"h-4 w-4 ml-auto"})):w("",!0)],2),e("button",{onClick:i[3]||(i[3]=h=>l("system")),class:K(["w-full flex items-center space-x-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",{"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400":g(v)==="system"}])},[b(g(ye),{class:"h-4 w-4"}),i[6]||(i[6]=e("span",null,"システム",-1)),g(v)==="system"?(s(),z(g(N),{key:0,class:"h-4 w-4 ml-auto"})):w("",!0)],2)])])):w("",!0)]))}},Ee={class:"h-16 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 flex items-center justify-between px-6"},Pe={class:"flex items-center font-bold text-gray-900 dark:text-gray-100"},Te={key:0},Oe={key:1},Ue={key:2},Ve={class:"flex items-center space-x-4"},ze={class:"relative search-container"},Fe={key:1,class:"absolute top-full left-0 right-0 mt-1 bg-white dark:bg-gray-800 rounded-md shadow-lg border border-gray-200 dark:border-gray-700 max-h-96 overflow-y-auto z-50"},Ie={key:0,class:"p-4 text-center text-gray-500"},Ze={key:1,class:"p-4 text-center text-red-500"},Re={key:2,class:"py-2"},He=["onClick"],Ke={class:"flex items-start space-x-3"},Ne={class:"flex-shrink-0"},We={class:"w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center"},qe={class:"text-sm font-medium text-gray-600"},Qe={class:"flex-1 min-w-0"},Xe={class:"flex items-center space-x-2"},Ge={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},Je={class:"text-xs text-gray-500 dark:text-gray-400"},Ye={class:"text-xs text-gray-400 dark:text-gray-500"},et={class:"mt-1 text-sm text-gray-700 dark:text-gray-300"},tt=["innerHTML"],st={key:3,class:"p-4 text-center text-gray-500"},at={class:"text-sm font-medium"},rt={key:0,class:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg py-1 z-50 border border-gray-200 dark:border-gray-700"},ot=["href"],nt=["src","alt"],lt={__name:"MainHeader",props:{activeChannel:Object,activeDirectMessage:Object},setup(r){var V;const u=(V=le().props.auth)==null?void 0:V.user,m=x(!1),d=x(null),c=x(""),o=x([]),l=x(!1),p=x(!1),n=x("");function i(S,M){let O;return function(...F){const B=()=>{O=null,S.apply(this,F)};clearTimeout(O),O=setTimeout(B,M)}}const h=i(async S=>{if(!S.trim()){o.value=[],p.value=!1;return}l.value=!0,n.value="";try{const M=await P.get("/messages/search",{params:{q:S.trim()}});o.value=M.data.messages,p.value=!0}catch(M){console.error("Search error:",M),n.value="検索中にエラーが発生しました",o.value=[]}finally{l.value=!1}},300),f=()=>{h(c.value)},$=()=>{c.value="",o.value=[],p.value=!1,n.value=""},C=S=>{ee.visit(`/dashboard?channel=${S.channel.id}&message=${S.id}`),$()},U=(S,M)=>{if(!M)return S;const O=new RegExp(`(${M})`,"gi");return S.replace(O,'<mark class="bg-yellow-200 text-black px-1 rounded">$1</mark>')},j=()=>{ee.post(route("logout"))},_=()=>{m.value=!m.value},L=()=>{m.value=!1},T=S=>{d.value&&!d.value.contains(S.target)&&L();const M=document.querySelector(".search-container");M&&!M.contains(S.target)&&(p.value=!1)};return W(()=>{document.addEventListener("click",T)}),ne(()=>{document.removeEventListener("click",T)}),(S,M)=>{var O,F,B;return s(),a("div",Ee,[e("div",null,[e("button",Pe,[r.activeChannel?(s(),a("span",Te,y(r.activeChannel.name),1)):r.activeDirectMessage?(s(),a("span",Oe,y(r.activeDirectMessage.name),1)):(s(),a("span",Ue,"チャンネルまたはダイレクトメッセージを選択してください")),b(g(Q),{class:"h-5 w-5 ml-1"})])]),e("div",Ve,[b(Ae),b(g(pe),{class:"h-6 w-6 text-gray-500 dark:text-gray-400"}),e("div",ze,[b(g(ke),{class:"h-5 w-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),G(e("input",{"onUpdate:modelValue":M[0]||(M[0]=E=>c.value=E),onInput:f,onFocus:M[1]||(M[1]=E=>p.value=!0),type:"text",placeholder:"メッセージを検索する",class:"bg-gray-100 dark:bg-gray-700 rounded-md w-80 pl-10 pr-8 py-1.5 focus:ring-blue-500 focus:border-blue-500 border-transparent text-gray-900 dark:text-gray-100"},null,544),[[J,c.value]]),c.value?(s(),a("button",{key:0,onClick:$,class:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",title:"検索をクリア"},M[2]||(M[2]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))):w("",!0),p.value&&(o.value.length>0||l.value||n.value)?(s(),a("div",Fe,[l.value?(s(),a("div",Ie,M[3]||(M[3]=[e("div",{class:"flex items-center justify-center"},[e("svg",{class:"animate-spin h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),I(" 検索中... ")],-1)]))):n.value?(s(),a("div",Ze,y(n.value),1)):o.value.length>0?(s(),a("div",Re,[(s(!0),a(R,null,H(o.value,E=>(s(),a("div",{key:E.id,onClick:Z=>C(E),class:"px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer border-b border-gray-100 dark:border-gray-700 last:border-b-0"},[e("div",Ke,[e("div",Ne,[e("div",We,[e("span",qe,y(E.user.name.charAt(0).toUpperCase()),1)])]),e("div",Qe,[e("div",Xe,[e("span",Ge,y(E.user.name),1),e("span",Je,"#"+y(E.channel.name),1),e("span",Ye,y(E.date)+" "+y(E.time),1)]),e("div",et,[e("span",{innerHTML:U(E.content,c.value)},null,8,tt)])])])],8,He))),128))])):(s(),a("div",st,' "'+y(c.value)+'" に一致するメッセージが見つかりませんでした ',1))])):w("",!0)]),e("div",{ref_key:"userMenuRef",ref:d,class:"relative"},[e("button",{onClick:_,class:"flex items-center space-x-2 text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100 focus:outline-none"},[b(g(ve),{class:"h-8 w-8"}),e("span",at,y((O=g(u))==null?void 0:O.name),1),b(g(Q),{class:"h-4 w-4"})]),m.value?(s(),a("div",rt,[e("a",{href:S.route("profile.show"),class:"flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 border-b border-gray-100 dark:border-gray-700"},[e("img",{src:(F=g(u))==null?void 0:F.profile_photo_url,alt:(B=g(u))==null?void 0:B.name,class:"w-8 h-8 rounded-full object-cover mr-2 border border-gray-300 dark:border-gray-600"},null,8,nt),M[4]||(M[4]=e("span",null,"プロフィール",-1))],8,ot),e("button",{onClick:j,class:"block w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}," ログアウト ")])):w("",!0)],512)])])}}},it={class:"p-4 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700"},ct={class:"border border-gray-200 dark:border-gray-600 rounded-lg p-2 flex flex-col"},dt={class:"relative"},ut=["disabled"],ht={key:0,class:"mt-2"},vt=["src"],gt={key:1,class:"mt-2"},mt={class:"text-xs text-gray-500"},ft={key:3,class:"emoji-picker-popover absolute left-0 bottom-12 z-50 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded shadow-lg p-2 w-80 max-h-60 overflow-y-auto flex flex-wrap gap-1"},pt=["onClick"],yt={class:"flex items-center justify-between mt-2"},xt={class:"flex items-center space-x-2"},kt={class:"cursor-pointer text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300"},_t={class:"text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300"},wt={class:"text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300"},bt={class:"flex items-center space-x-2"},$t={class:"text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300"},Ct=["disabled"],Mt={__name:"MessageInput",props:{activeChannel:Object,activeDirectMessage:Object},emits:["messageSent"],setup(r,{emit:v}){const u=r,m=v,d=x(""),c=x(!1),o=x(!1),l=["😀","😃","😄","😁","😆","😅","😂","🤣","😊","😇","🙂","🙃","😉","😌","😍","🥰","😘","😗","😙","😚","😋","😜","😝","😛","🤑","🤗","🤩","🤔","🤨","😐","😑","😶","🙄","😏","😣","😥","😮","🤐","😯","😪","😫","🥱","😴","😌","😛","😜","😝","🤤","😒","😓","😔","😕","🙃","🤑","😲","☹️","🙁","😖","😞","😟","😤","😢","😭","😦","😧","😨","😩","🤯","😬","😰","😱","🥵","🥶","😳","🤪","😵","😡","😠","🤬","😷","🤒","🤕","🤢","🤮","🥴","😇","🥳","🥺","🤠","😎","🤓","🧐","😕","🤑","🤡","🤥","🤫","🤭","🫢","🫣","🫡","🤗","🤔","🤭","🤫","🤥","🫠","🫨","🫤","🫦","👍","👎","👏","🙌","🙏","💪","👀","👋","🤙","💯","🔥","✨","🎉","🎊","❤️","🧡","💛","💚","💙","💜","🖤","🤍","🤎","💔","💕","💞","💓","💗","💖","💘"],p=x(null),n=x(null),i=j=>{const _=j.target.files[0];if(p.value=_||null,_&&_.type.startsWith("image/")){const L=new FileReader;L.onload=T=>{n.value=T.target.result},L.readAsDataURL(_)}else n.value=null},h=()=>{p.value=null,n.value=null;const j=document.getElementById("message-file-input");j&&(j.value="")},f=async()=>{var j;if(!(!d.value.trim()&&!p||!u.activeChannel&&!u.activeDirectMessage)){c.value=!0;try{const _=new FormData;_.append("content",d.value.trim()),u.activeChannel&&_.append("channel_id",u.activeChannel.id),u.activeDirectMessage&&_.append("receiver_id",u.activeDirectMessage.id),p.value&&_.append("file",p.value);const L=(j=document.head.querySelector('meta[name="csrf-token"]'))==null?void 0:j.content,T={"Content-Type":"multipart/form-data"};L&&(T["X-CSRF-TOKEN"]=L);let V;u.activeDirectMessage?V=await P.post("/api/direct-messages",_,{headers:T}):V=await P.post("/messages",_,{headers:T}),m("messageSent",V.data),d.value="",h()}catch(_){console.error("Message sending failed:",_)}finally{c.value=!1}}},$=j=>{j.key==="Enter"&&!j.shiftKey&&(j.preventDefault(),f())},C=j=>{const _=document.activeElement;if(_&&_.selectionStart!==void 0){const L=_.selectionStart,T=_.selectionEnd;d.value=d.value.substring(0,L)+j+d.value.substring(T),setTimeout(()=>{_.selectionStart=_.selectionEnd=L+j.length,_.focus()},0)}else d.value+=j;o.value=!1},U=j=>{o.value&&!j.target.closest(".emoji-picker-popover")&&!j.target.closest(".emoji-picker-toggle")&&(o.value=!1)};return typeof window<"u"&&window.addEventListener("click",U),(j,_)=>(s(),a("div",it,[e("div",ct,[e("div",dt,[G(e("textarea",{"onUpdate:modelValue":_[0]||(_[0]=L=>d.value=L),onKeypress:$,class:"w-full border-none focus:ring-0 resize-none bg-transparent text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400",placeholder:"メモを書く",rows:"1",disabled:c.value},null,40,ut),[[J,d.value]]),n.value?(s(),a("div",ht,[e("img",{src:n.value,alt:"preview",class:"max-h-32 rounded border"},null,8,vt)])):p.value&&p.value.name?(s(),a("div",gt,[e("span",mt,y(p.value.name),1)])):w("",!0),p.value?(s(),a("button",{key:2,onClick:h,class:"text-xs text-red-500 ml-2"},"ファイルを削除")):w("",!0),o.value?(s(),a("div",ft,[(s(),a(R,null,H(l,L=>e("button",{key:L,class:"text-2xl p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",onClick:te(T=>C(L),["stop"]),type:"button"},y(L),9,pt)),64))])):w("",!0)]),e("div",yt,[e("div",xt,[e("label",kt,[b(g(be),{class:"h-6 w-6"}),e("input",{id:"message-file-input",type:"file",class:"hidden",accept:"image/*,.pdf,.doc,.docx,.xls,.xlsx",onChange:i},null,32)]),e("button",_t,[b(g(Ce),{class:"h-6 w-6"})]),e("button",wt,[b(g(_e),{class:"h-6 w-6"})])]),e("div",bt,[e("button",{class:"emoji-picker-toggle text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300",onClick:_[1]||(_[1]=te(L=>o.value=!o.value,["stop"])),title:"絵文字を挿入",type:"button"},[b(g(xe),{class:"h-6 w-6"})]),e("button",$t,[b(g(fe),{class:"h-6 w-6"})]),e("button",{onClick:f,disabled:!d.value.trim()&&!p.value||c.value,class:"bg-gray-800 text-white rounded p-1 hover:bg-gray-700 disabled:bg-gray-400 disabled:cursor-not-allowed",type:"button"},[b(g(we),{class:"h-5 w-5"})],8,Ct)])])])]))}},jt={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Dt={class:"bg-white rounded-lg p-6 w-full max-w-md mx-4"},Lt={class:"flex items-center justify-between mb-4"},St={class:"mb-4"},Bt=["disabled"],At={key:0,class:"mt-2 text-red-600 text-sm"},Et={class:"flex justify-end space-x-3"},Pt=["disabled"],Tt=["disabled"],Ot={__name:"MessageEditModal",props:{show:Boolean,message:Object,activeDirectMessage:Object},emits:["close","messageUpdated"],setup(r,{emit:v}){const u=r,m=v,d=x(""),c=x(!1),o=x("");X(()=>u.message,i=>{i&&(d.value=i.content,o.value="")},{immediate:!0});const l=async()=>{var i,h;if(!(!d.value.trim()||!u.message)){c.value=!0,o.value="";try{let f;u.activeDirectMessage?f=await P.put(`/api/direct-messages/${u.message.id}`,{content:d.value.trim()}):f=await P.put(`/messages/${u.message.id}`,{content:d.value.trim()}),m("messageUpdated",f.data),m("close")}catch(f){console.error("Message update failed:",f),(h=(i=f.response)==null?void 0:i.data)!=null&&h.message?o.value=f.response.data.message:o.value="メッセージの更新に失敗しました"}finally{c.value=!1}}},p=()=>{var i;d.value=((i=u.message)==null?void 0:i.content)||"",o.value="",m("close")},n=i=>{i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),l())};return(i,h)=>r.show?(s(),a("div",jt,[e("div",Dt,[e("div",Lt,[h[1]||(h[1]=e("h3",{class:"text-lg font-semibold"},"メッセージを編集",-1)),e("button",{onClick:p,class:"text-gray-500 hover:text-gray-700"},[b(g(ie),{class:"h-6 w-6"})])]),e("div",St,[G(e("textarea",{"onUpdate:modelValue":h[0]||(h[0]=f=>d.value=f),onKeypress:n,class:"w-full border border-gray-300 rounded-lg p-3 focus:ring-blue-500 focus:border-blue-500 resize-none",placeholder:"メッセージを入力してください",rows:"4",disabled:c.value},null,40,Bt),[[J,d.value]]),o.value?(s(),a("div",At,y(o.value),1)):w("",!0)]),e("div",Et,[e("button",{onClick:p,class:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:c.value}," キャンセル ",8,Pt),e("button",{onClick:l,disabled:!d.value.trim()||c.value,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center space-x-2"},[b(g(N),{class:"h-4 w-4"}),e("span",null,y(c.value?"更新中...":"更新"),1)],8,Tt)])])])):w("",!0)}},Ut={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Vt={class:"bg-white rounded-lg p-6 w-full max-w-md mx-4"},zt={class:"flex items-center justify-between mb-4"},Ft={class:"mb-4 text-gray-700"},It={class:"mt-2 p-2 bg-gray-100 rounded text-gray-800"},Zt={key:0,class:"mt-2 text-red-600 text-sm"},Rt={class:"flex justify-end space-x-3"},Ht=["disabled"],Kt=["disabled"],Nt={__name:"MessageDeleteModal",props:{show:Boolean,message:Object,activeDirectMessage:Object},emits:["close","messageDeleted"],setup(r,{emit:v}){const u=r,m=v,d=x(!1),c=x(""),o=async()=>{var p,n;if(u.message){d.value=!0,c.value="";try{u.activeDirectMessage?await P.delete(`/api/direct-messages/${u.message.id}`):await P.delete(`/messages/${u.message.id}`),m("messageDeleted",u.message.id),m("close")}catch(i){c.value=((n=(p=i.response)==null?void 0:p.data)==null?void 0:n.message)||"削除に失敗しました"}finally{d.value=!1}}},l=()=>{c.value="",m("close")};return(p,n)=>{var i;return r.show?(s(),a("div",Ut,[e("div",Vt,[e("div",zt,[n[0]||(n[0]=e("h3",{class:"text-lg font-semibold"},"メッセージを削除",-1)),e("button",{onClick:l,class:"text-gray-500 hover:text-gray-700"},[b(g(ie),{class:"h-6 w-6"})])]),e("div",Ft,[n[1]||(n[1]=I(" 本当にこのメッセージを削除しますか？ ")),e("div",It,y((i=r.message)==null?void 0:i.content),1),c.value?(s(),a("div",Zt,y(c.value),1)):w("",!0)]),e("div",Rt,[e("button",{onClick:l,class:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:d.value}," キャンセル ",8,Ht),e("button",{onClick:o,disabled:d.value,class:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center space-x-2"},[b(g($e),{class:"h-4 w-4"}),e("span",null,y(d.value?"削除中...":"削除"),1)],8,Kt)])])])):w("",!0)}}},Wt=["title","disabled"],qt={key:0,class:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Qt={key:1,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-4 w-4"},Xt={__name:"PinMessageButton",props:{messageId:{type:[String,Number],required:!0},channelId:{type:[String,Number],required:!0},isPinned:{type:Boolean,default:!1}},emits:["pin-toggled"],setup(r,{emit:v}){const u=r,m=v,d=x(!1),c=async()=>{if(!d.value){d.value=!0;try{if(u.isPinned)await P.delete("/api/pinned-messages",{data:{message_id:u.messageId,channel_id:u.channelId}}),m("pin-toggled",!1,null);else{const o=await P.post("/api/pinned-messages",{message_id:u.messageId,channel_id:u.channelId});m("pin-toggled",!0,o.data.id)}}catch(o){console.error("Pin toggle failed:",o)}finally{d.value=!1}}};return(o,l)=>(s(),a("button",{onClick:c,class:K(["p-1 rounded transition-colors",r.isPinned?"text-yellow-500 dark:text-yellow-400 hover:text-yellow-700 dark:hover:text-yellow-300":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"]),title:r.isPinned?"ピン留めを解除":"メッセージをピン留め",disabled:d.value},[d.value?(s(),a("svg",qt,l[0]||(l[0]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(s(),a("svg",Qt,l[1]||(l[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.112 2.13"},null,-1)])))],10,Wt))}},Gt={class:"bg-gray-50 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700"},Jt={class:"p-4"},Yt={class:"flex items-center justify-between mb-3"},es={class:"text-sm font-medium text-gray-900 dark:text-gray-100 flex items-center"},ts={class:"ml-2 text-xs text-gray-500 dark:text-gray-400"},ss={key:0,class:"flex justify-center py-4"},as={key:1,class:"text-center py-4"},rs={key:2,class:"space-y-3 max-h-96 overflow-y-auto"},os={class:"flex items-start space-x-3"},ns=["src","alt"],ls={class:"flex-1 min-w-0"},is={class:"flex items-center justify-between"},cs={class:"flex items-center space-x-2"},ds={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},us={class:"text-xs text-gray-500 dark:text-gray-400"},hs=["onClick"],vs={class:"text-sm text-gray-700 dark:text-gray-300 mt-1"},gs={key:0,class:"mt-2"},ms=["src","alt"],fs={key:1,class:"flex items-center space-x-2 text-xs text-gray-500 dark:text-gray-400"},ps={class:"text-xs text-gray-500 dark:text-gray-400 mt-2"},ys={__name:"PinnedMessagesList",props:{channelId:{type:[String,Number],required:!0}},emits:["pin-removed"],setup(r,{expose:v,emit:u}){const m=r,d=u,c=x([]),o=x(!1),l=x(!1),p=async()=>{o.value=!0;try{const f=await P.get("/api/pinned-messages",{params:{channel_id:m.channelId}});c.value=f.data}catch(f){console.error("Failed to fetch pinned messages:",f)}finally{o.value=!1}},n=async f=>{try{await P.delete(`/api/pinned-messages/${f}`);const $=c.value.findIndex(C=>C.id===f);$!==-1&&c.value.splice($,1),d("pin-removed",f)}catch($){console.error("Failed to remove pin:",$)}},i=()=>{l.value=!l.value};return v({refreshPinnedMessages:()=>{p()}}),W(()=>{p()}),(f,$)=>(s(),a("div",Gt,[e("div",Jt,[e("div",Yt,[e("h3",es,[$[0]||($[0]=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-4 w-4 mr-2 text-yellow-500"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.112 2.13"})],-1)),$[1]||($[1]=I(" ピン留めされたメッセージ ")),e("span",ts,"("+y(c.value.length)+")",1)]),c.value.length>0?(s(),a("button",{key:0,onClick:i,class:"text-xs text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"},y(l.value?"折りたたむ":"展開"),1)):w("",!0)]),o.value?(s(),a("div",ss,$[2]||($[2]=[e("svg",{class:"animate-spin h-5 w-5 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):c.value.length===0?(s(),a("div",as,$[3]||($[3]=[e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"ピン留めされたメッセージはありません",-1)]))):l.value?(s(),a("div",rs,[(s(!0),a(R,null,H(c.value,C=>(s(),a("div",{key:C.id,class:"bg-white dark:bg-gray-700 rounded-lg p-3 border border-gray-200 dark:border-gray-600"},[e("div",os,[e("img",{src:C.message.user.avatar,alt:C.message.user.name,class:"w-8 h-8 rounded-full flex-shrink-0"},null,8,ns),e("div",ls,[e("div",is,[e("div",cs,[e("span",ds,y(C.message.user.name),1),e("span",us,y(C.message.time),1)]),e("button",{onClick:U=>n(C.id),class:"text-gray-400 hover:text-red-500 dark:hover:text-red-400 p-1",title:"ピン留めを解除"},$[4]||($[4]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-4 w-4"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,hs)]),e("p",vs,y(C.message.content),1),C.message.file_path?(s(),a("div",gs,[C.message.file_mime&&C.message.file_mime.startsWith("image/")?(s(),a("img",{key:0,src:`/storage/${C.message.file_path}`,alt:C.message.file_name,class:"max-h-24 rounded border"},null,8,ms)):(s(),a("div",fs,[$[5]||($[5]=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-4 w-4"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.112 2.13"})],-1)),e("span",null,y(C.message.file_name),1)]))])):w("",!0),e("div",ps,y(C.pinned_by.name)+" がピン留めしました ",1)])])]))),128))])):w("",!0)])]))}},xs={class:"flex-1 flex flex-col bg-white dark:bg-gray-900"},ks={class:"flex-1 p-6 overflow-y-auto"},_s={class:"w-10 h-10 rounded bg-purple-400 mr-4 shrink-0"},ws=["src"],bs={class:"flex-1"},$s={class:"flex items-center justify-between"},Cs={class:"font-bold text-gray-900 dark:text-gray-100"},Ms={class:"text-xs text-gray-500 dark:text-gray-400 font-normal ml-2"},js={class:"flex items-center space-x-2 opacity-0 group-hover:opacity-100 transition-opacity"},Ds=["onClick"],Ls=["onClick"],Ss={class:"mt-1"},Bs={key:0},As={key:0,class:"mt-2"},Es=["src","alt","onClick"],Ps=["src","onClick"],Ts=["src","onClick"],Os=["src","onClick"],Us=["src","onClick"],Vs={key:5},zs=["href","download"],Fs={class:"text-xs text-gray-400 ml-2"},Is={class:"w-10 h-10 rounded bg-purple-400 mr-4 shrink-0"},Zs=["src"],Rs={class:"flex-1"},Hs={class:"flex items-center justify-between"},Ks={class:"font-bold text-gray-900 dark:text-gray-100"},Ns={class:"text-xs text-gray-500 dark:text-gray-400 font-normal ml-2"},Ws={class:"flex items-center space-x-2 opacity-0 group-hover:opacity-100 transition-opacity"},qs=["onClick"],Qs=["onClick"],Xs={class:"mt-1"},Gs={key:0},Js={key:0,class:"mt-2"},Ys=["src","alt","onClick"],ea=["src","onClick"],ta=["src","onClick"],sa=["src","onClick"],aa=["src","onClick"],ra={key:5},oa=["href","download"],na={class:"text-xs text-gray-400 ml-2"},la={key:2,class:"text-center text-gray-400 mt-10"},ia={key:0},ca=["src","alt"],da=["src"],ua=["src"],ha=["src"],va=["src"],ga={__name:"MainContent",props:{messages:{type:Array,default:()=>[]},activeChannel:Object,activeDirectMessage:Object},emits:["messageSent","messageUpdated","messageDeleted"],setup(r,{emit:v}){var Y;const m=(Y=le().props.auth)==null?void 0:Y.user,d=r,c=v,o=x([...d.messages||[]]),l=x(!1),p=x(null),n=x(!1),i=x(null),h=x(null),f=x(!1),$=x({}),C=x({}),U=x(null);X(()=>d.messages,k=>{o.value=[...k||[]],k&&k.forEach(D=>{D.is_pinned!==void 0&&($.value[D.id]=D.is_pinned),D.pinned_message_id!==void 0&&(C.value[D.id]=D.pinned_message_id)})},{deep:!0});const j=k=>{o.value.unshift(k),c("messageSent",k)},_=k=>{const D=o.value.findIndex(t=>t.id===k.id);D!==-1&&(o.value[D]=k),c("messageUpdated",k)},L=k=>{const D=o.value.findIndex(t=>t.id===k);D!==-1&&o.value.splice(D,1),c("messageDeleted",k)},T=(k,D,t=null)=>{$.value[k]=D,t?C.value[k]=t:delete C.value[k],U.value&&U.value.refreshPinnedMessages()},V=k=>{},S=k=>{p.value=k,l.value=!0},M=()=>{l.value=!1,p.value=null},O=k=>{i.value=k,n.value=!0},F=()=>{n.value=!1,i.value=null},B=k=>{h.value=k,f.value=!0},E=()=>{f.value=!1,h.value=null},Z=k=>m&&k.user.id===m.id;return(k,D)=>(s(),a("div",xs,[b(lt,{"active-channel":r.activeChannel,"active-direct-message":r.activeDirectMessage},null,8,["active-channel","active-direct-message"]),r.activeChannel?(s(),z(ys,{key:0,"channel-id":r.activeChannel.id,onPinRemoved:D[0]||(D[0]=t=>V()),ref_key:"pinnedMessagesListRef",ref:U},null,8,["channel-id"])):w("",!0),e("div",ks,[r.activeChannel?(s(!0),a(R,{key:0},H(o.value,t=>(s(),a("div",{key:t.id,class:"flex items-start mb-4 group hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg p-2 -m-2"},[e("div",_s,[e("img",{src:t.user.avatar,alt:"avatar",class:"w-8 h-8 rounded-full"},null,8,ws)]),e("div",bs,[e("div",$s,[e("p",Cs,[I(y(t.user.name)+" ",1),e("span",Ms,y(t.time),1)]),e("div",js,[b(Xt,{"message-id":t.id,"channel-id":r.activeChannel.id,"is-pinned":$.value[t.id]||!1,onPinToggled:(A,ce)=>T(t.id,A,ce)},null,8,["message-id","channel-id","is-pinned","onPinToggled"]),Z(t)?(s(),a("button",{key:0,onClick:A=>S(t),class:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 p-1 rounded",title:"メッセージを編集"},[b(g(re),{class:"h-4 w-4"})],8,Ds)):w("",!0),Z(t)?(s(),a("button",{key:1,onClick:A=>O(t),class:"text-red-500 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 p-1 rounded",title:"メッセージを削除"},D[1]||(D[1]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-4 w-4"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Ls)):w("",!0)])]),e("div",Ss,[t.content?(s(),a("span",Bs,y(t.content),1)):w("",!0)]),t.file_path?(s(),a("div",As,[t.file_mime&&t.file_mime.startsWith("image/")?(s(),a("img",{key:0,src:`/storage/${t.file_path}`,alt:t.file_name,class:"max-h-48 rounded border cursor-pointer hover:opacity-80 transition",onClick:A=>B({type:"image",src:`/storage/${t.file_path}`,name:t.file_name,mime:t.file_mime})},null,8,Es)):t.file_mime&&t.file_mime.startsWith("video/")?(s(),a("video",{key:1,src:`/storage/${t.file_path}`,controls:"",class:"max-h-48 rounded border cursor-pointer hover:opacity-80 transition",onClick:A=>B({type:"video",src:`/storage/${t.file_path}`,name:t.file_name,mime:t.file_mime})},null,8,Ps)):t.file_mime&&t.file_mime.startsWith("audio/")?(s(),a("audio",{key:2,src:`/storage/${t.file_path}`,controls:"",class:"w-full cursor-pointer hover:opacity-80 transition",onClick:A=>B({type:"audio",src:`/storage/${t.file_path}`,name:t.file_name,mime:t.file_mime})},null,8,Ts)):t.file_mime==="application/pdf"?(s(),a("iframe",{key:3,src:`/storage/${t.file_path}`,class:"w-full max-h-96 border rounded cursor-pointer hover:opacity-80 transition",onClick:A=>B({type:"pdf",src:`/storage/${t.file_path}`,name:t.file_name,mime:t.file_mime})},null,8,Os)):["application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(t.file_mime)?(s(),a("iframe",{key:4,src:`https://docs.google.com/gview?url=${k.location.origin}/storage/${t.file_path}&embedded=true`,class:"w-full max-h-96 border rounded cursor-pointer hover:opacity-80 transition",onClick:A=>B({type:"doc",src:`https://docs.google.com/gview?url=${k.location.origin}/storage/${t.file_path}&embedded=true`,name:t.file_name,mime:t.file_mime})},null,8,Us)):(s(),a("div",Vs,[e("a",{href:`/storage/${t.file_path}`,download:t.file_name,class:"text-blue-600 underline",target:"_blank"},y(t.file_name),9,zs),e("span",Fs,"("+y((t.file_size/1024).toFixed(1))+" KB)",1)]))])):w("",!0)])]))),128)):r.activeDirectMessage?(s(!0),a(R,{key:1},H(o.value,t=>(s(),a("div",{key:t.id,class:"flex items-start mb-4 group hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg p-2 -m-2"},[e("div",Is,[e("img",{src:t.user.avatar,alt:"avatar",class:"w-8 h-8 rounded-full"},null,8,Zs)]),e("div",Rs,[e("div",Hs,[e("p",Ks,[I(y(t.user.name)+" ",1),e("span",Ns,y(t.time),1)]),e("div",Ws,[Z(t)?(s(),a("button",{key:0,onClick:A=>S(t),class:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 p-1 rounded",title:"メッセージを編集"},[b(g(re),{class:"h-4 w-4"})],8,qs)):w("",!0),Z(t)?(s(),a("button",{key:1,onClick:A=>O(t),class:"text-red-500 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 p-1 rounded",title:"メッセージを削除"},D[2]||(D[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-4 w-4"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Qs)):w("",!0)])]),e("div",Xs,[t.content?(s(),a("span",Gs,y(t.content),1)):w("",!0)]),t.file_path?(s(),a("div",Js,[t.file_mime&&t.file_mime.startsWith("image/")?(s(),a("img",{key:0,src:`/storage/${t.file_path}`,alt:t.file_name,class:"max-h-48 rounded border cursor-pointer hover:opacity-80 transition",onClick:A=>B({type:"image",src:`/storage/${t.file_path}`,name:t.file_name,mime:t.file_mime})},null,8,Ys)):t.file_mime&&t.file_mime.startsWith("video/")?(s(),a("video",{key:1,src:`/storage/${t.file_path}`,controls:"",class:"max-h-48 rounded border cursor-pointer hover:opacity-80 transition",onClick:A=>B({type:"video",src:`/storage/${t.file_path}`,name:t.file_name,mime:t.file_mime})},null,8,ea)):t.file_mime&&t.file_mime.startsWith("audio/")?(s(),a("audio",{key:2,src:`/storage/${t.file_path}`,controls:"",class:"w-full cursor-pointer hover:opacity-80 transition",onClick:A=>B({type:"audio",src:`/storage/${t.file_path}`,name:t.file_name,mime:t.file_mime})},null,8,ta)):t.file_mime==="application/pdf"?(s(),a("iframe",{key:3,src:`/storage/${t.file_path}`,class:"w-full max-h-96 border rounded cursor-pointer hover:opacity-80 transition",onClick:A=>B({type:"pdf",src:`/storage/${t.file_path}`,name:t.file_name,mime:t.file_mime})},null,8,sa)):["application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(t.file_mime)?(s(),a("iframe",{key:4,src:`https://docs.google.com/gview?url=${k.location.origin}/storage/${t.file_path}&embedded=true`,class:"w-full max-h-96 border rounded cursor-pointer hover:opacity-80 transition",onClick:A=>B({type:"doc",src:`https://docs.google.com/gview?url=${k.location.origin}/storage/${t.file_path}&embedded=true`,name:t.file_name,mime:t.file_mime})},null,8,aa)):(s(),a("div",ra,[e("a",{href:`/storage/${t.file_path}`,download:t.file_name,class:"text-blue-600 underline",target:"_blank"},y(t.file_name),9,oa),e("span",na,"("+y((t.file_size/1024).toFixed(1))+" KB)",1)]))])):w("",!0)])]))),128)):(s(),a("div",la,"チャンネルまたはダイレクトメッセージを選択してください"))]),r.activeChannel||r.activeDirectMessage?(s(),z(Mt,{key:1,"active-channel":r.activeChannel,"active-direct-message":r.activeDirectMessage,onMessageSent:j},null,8,["active-channel","active-direct-message"])):w("",!0),b(Ot,{show:l.value,message:p.value,"active-direct-message":r.activeDirectMessage,onClose:M,onMessageUpdated:_},null,8,["show","message","active-direct-message"]),b(Nt,{show:n.value,message:i.value,"active-direct-message":r.activeDirectMessage,onClose:F,onMessageDeleted:L},null,8,["show","message","active-direct-message"]),b(me,{show:f.value,"max-width":"4xl",onClose:E},{title:q(()=>{var t;return[I(y((t=h.value)==null?void 0:t.name),1)]}),content:q(()=>[h.value?(s(),a("div",ia,[h.value.type==="image"?(s(),a("img",{key:0,src:h.value.src,alt:h.value.name,class:"max-h-[70vh] mx-auto rounded border"},null,8,ca)):h.value.type==="video"?(s(),a("video",{key:1,src:h.value.src,controls:"",class:"max-h-[70vh] mx-auto rounded border"},null,8,da)):h.value.type==="audio"?(s(),a("audio",{key:2,src:h.value.src,controls:"",class:"w-full mx-auto"},null,8,ua)):h.value.type==="pdf"?(s(),a("iframe",{key:3,src:h.value.src,class:"w-full min-h-[60vh] border rounded"},null,8,ha)):h.value.type==="doc"?(s(),a("iframe",{key:4,src:h.value.src,class:"w-full min-h-[60vh] border rounded"},null,8,va)):w("",!0)])):w("",!0)]),footer:q(()=>[e("button",{onClick:E,class:"px-4 py-2 bg-gray-700 text-white rounded hover:bg-gray-600"},"閉じる")]),_:1},8,["show"])]))}},ma={class:"flex h-screen bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200"},fa={class:"flex-1 flex flex-col"},_a={__name:"AppLayout",props:{title:String,channels:Array,"direct-messages":Array,directMessages:Array,messages:Array,activeChannel:Object,activeDirectMessage:Object,manualOffline:Boolean},emits:["selectChannel","newChannelAdded","messageSent","messageUpdated","messageDeleted","toggleManualOffline","channelDeleted","channelLeft","selectDirectMessage","directMessageStarted"],setup(r,{emit:v}){const u=r,m=v,d=de(()=>u.directMessages||u["direct-messages"]||[]);return(c,o)=>(s(),a("div",null,[b(g(ue),{title:r.title},null,8,["title"]),e("div",ma,[b(he),b(ge,{channels:r.channels,"direct-messages":d.value,"manual-offline":r.manualOffline,onToggleManualOffline:o[0]||(o[0]=l=>m("toggleManualOffline",l)),onSelectChannel:o[1]||(o[1]=l=>m("selectChannel",l)),onNewChannelAdded:o[2]||(o[2]=l=>m("newChannelAdded",l)),onChannelDeleted:o[3]||(o[3]=l=>m("channelDeleted",l)),onChannelLeft:o[4]||(o[4]=l=>m("channelLeft",l)),onSelectDirectMessage:o[5]||(o[5]=l=>m("selectDirectMessage",l)),onDirectMessageStarted:o[6]||(o[6]=l=>m("directMessageStarted",l))},null,8,["channels","direct-messages","manual-offline"]),e("div",fa,[se(c.$slots,"notifications"),se(c.$slots,"default"),r.activeChannel||r.activeDirectMessage?(s(),z(ga,{key:0,messages:r.messages,"active-channel":r.activeChannel,"active-direct-message":r.activeDirectMessage,onMessageSent:o[7]||(o[7]=l=>m("messageSent",l)),onMessageUpdated:o[8]||(o[8]=l=>m("messageUpdated",l)),onMessageDeleted:o[9]||(o[9]=l=>m("messageDeleted",l))},null,8,["messages","active-channel","active-direct-message"])):w("",!0)])])]))}};export{_a as _};
