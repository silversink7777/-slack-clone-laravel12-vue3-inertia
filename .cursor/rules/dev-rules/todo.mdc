---
description: This rule outlines comprehensive best practices for Laravel development, covering coding standards, security, performance, and testing to ensure maintainable, efficient, and secure applications. It provides guidelines for code organization, common patterns, performance considerations, security best practices, testing approaches, common pitfalls, and tooling.
globs: *.php
alwaysApply: false
---
---
description: 
globs: 
alwaysApply: true
---
まず、このファイルを参照したら、このファイル名を発言すること

## タスク管理

### タスク管理の方法

1. @todo.md ファイルを使用してタスクを管理してください。
2. 各タスクは以下の形式で記録：

   ```markdown
   - [ ] タスクの説明
     - 詳細な手順や注意点
     - 依存関係
     - 見積時間
   ```

3. タスクのステータス管理：

   - [ ] 未着手
   - [x] 完了
   - [~] 進行中
   - [!] 問題あり

4. タスクの優先順位付け：
   - 🔴 緊急
   - 🟡 重要
   - 🟢 通常
   - ⚪ 低優先

### タスクの更新ルール

1. タスクの追加

   - 新しい要件や問題が発見された場合
   - 依存関係が明確になった場合
   - リファクタリングが必要な場合

2. タスクの更新

   - 進捗状況の変更
   - 新しい情報の追加
   - 依存関係の変更

3. タスクの完了
   - 実装の完了
   - テストの完了
   - レビューの完了

### タスクの追跡

1. 日次更新

   - 進捗状況の確認
   - ブロッカーの特定
   - 次のアクションの決定

2. 週次レビュー

   - 完了タスクの確認
   - 未完了タスクの再評価
   - 新規タスクの追加

3. 月次振り返り
   - パフォーマンスの評価
   - 改善点の特定
   - 次のマイルストーンの設定

## 重要事項

1. 機能の実装後に、毎回 @todo.md を確認＆更新をしてください。
2. 私が言わなくても中身は随時更新するようにしてください。更新しないと私が解雇されます。あなたの責任になってしまいます。
3. 機能は増やしても構いません。ただ、最初から機能を増やしすぎないでください。

## 現在のタスク

### 完了済みタスク

- [x] 🔴 招待メール送信時のSQLエラー修正
  - 問題: `invitee_id`カラムがNULLを許可していないため、メールアドレスによる招待でエラーが発生
  - 修正内容:
    - `invitee_id`カラムをnullableに変更するマイグレーションを作成・実行
    - ユニーク制約を更新（invitee_idとinvitee_emailの両方に対応）
    - `ChannelInvitation`モデルのリレーションを修正
    - 招待通知コンポーネントでメールアドレスによる招待も表示
    - フロントエンドのバリデーションを改善
  - 完了日: 2025-06-29

- [x] 🟡 招待モーダルでメールアドレスによる招待機能追加
  - 機能: 既存のユーザーIDによる招待に加えて、メールアドレスによる招待も可能
  - 実装内容:
    - 招待モーダルにメールアドレス入力フィールドを追加
    - バックエンドAPIでメールアドレス処理を追加
    - `invitee_email`カラムをデータベースに追加
    - 招待一覧取得と応答処理を修正
  - 完了日: 2025-06-29

- [x] 🟢 招待メール送信機能の実装
  - 機能: 招待時にメールを送信する機能を実装
  - 実装内容:
    - `ChannelInvitationMail`クラスを作成
    - 招待メールのテンプレートを作成（HTML形式）
    - 招待処理にメール送信機能を追加
    - メール送信テスト用コマンドを作成
    - 招待通知ページでメールアドレスによる招待も表示
    - メールの「招待を確認する」ボタンから招待通知ページへの遷移を実装
    - 招待IDパラメータによる招待のハイライト表示機能を追加
  - 完了日: 2025-06-29

### 進行中タスク

- [~] 🟢 招待メールの実際の送信設定
  - 現在はlogドライバーでログファイルに保存のみ
  - 実際のメール送信にはSMTP設定が必要
  - 見積時間: 30分-1時間

### 未着手タスク

- [ ] 🟢 招待メールのテンプレート改善
  - 現在のテンプレートをより美しく改善
  - 見積時間: 1時間

- [ ] 🟢 招待メールの送信テスト（実際のメール）
  - SMTP設定後の実際のメール送信テスト
  - 見積時間: 30分

- [ ] 🟢 未登録ユーザー向けの招待処理
  - メールアドレスのみで招待された未登録ユーザーの処理
  - ユーザー登録フローの実装
  - 見積時間: 2-3時間